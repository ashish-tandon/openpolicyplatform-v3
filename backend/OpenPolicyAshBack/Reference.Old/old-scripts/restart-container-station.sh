#!/bin/bash

echo "ğŸ”„ Restarting Container Station Application"
echo "=========================================="
echo ""

QNAP_HOST="192.168.2.152"
QNAP_USER="ashish101"

echo "ğŸ“‹ Current Status:"
echo "=================="
echo "âœ… Docker-compose file updated with API service"
echo "âœ… Configuration files in place"
echo "âŒ API container not running"
echo ""

echo "ğŸš€ Manual Restart Required:"
echo "=========================="
echo ""
echo "Since Container Station is a web-based interface, you need to:"
echo ""
echo "1. ğŸ“± Open Container Station:"
echo "   http://192.168.2.152:8080"
echo ""
echo "2. ğŸ” Find your OpenPolicy application"
echo "   - Look for the docker-compose application"
echo "   - It should show some containers running"
echo ""
echo "3. â¹ï¸ Stop the Application:"
echo "   - Click on the application"
echo "   - Click 'Stop' or 'Stop All'"
echo "   - Wait for all containers to stop"
echo ""
echo "4. â–¶ï¸ Start the Application:"
echo "   - Click 'Start' or 'Start All'"
echo "   - This will start ALL containers including the API"
echo "   - Wait 2-3 minutes for startup"
echo ""
echo "5. âœ… Verify API is Running:"
echo "   - Check that 'openpolicy_api' appears in the container list"
echo "   - Test: http://192.168.2.152:8000/health"
echo ""

echo "â±ï¸ Expected Timeline:"
echo "===================="
echo "â€¢ Stop application: 1-2 minutes"
echo "â€¢ Start application: 2-3 minutes"
echo "â€¢ API container startup: 1-2 minutes"
echo "â€¢ Health check: 30 seconds"
echo "â€¢ Total time: 5-8 minutes"
echo ""

echo "ğŸ§ª Test Commands (run after restart):"
echo "===================================="
echo "ssh ashish101@192.168.2.152 'curl -s http://localhost:8000/health'"
echo "ssh ashish101@192.168.2.152 './final-validation.sh'"
echo ""

echo "ğŸ¯ Success Indicators:"
echo "====================="
echo "âœ… API responds at http://192.168.2.152:8000/health"
echo "âœ… Dashboard loads real data"
echo "âœ… All containers in 'Running' status"
echo "âœ… Flower monitor shows active tasks"
echo ""

echo "ğŸ“Š After Restart:"
echo "================"
echo "â€¢ First data scraping: 15-30 minutes"
echo "â€¢ Complete collection: 2-4 hours"
echo "â€¢ Real-time updates: Continuous"
echo ""

echo "ğŸš€ Ready to restart!"
echo "Follow the steps above to complete your OpenPolicy system!" 